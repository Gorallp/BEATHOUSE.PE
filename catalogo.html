 
  <link rel="stylesheet" href="ESTILOS/E1.css">
  <link rel="stylesheet" href="ESTILOS/E4.css">
  <style>
    /* Pagination button styles */
    #pagination { display:flex; justify-content:center; align-items:center; margin:22px 0; gap:12px; }
    #pagination .pages { display:flex; gap:8px; }
    .page-btn {
      background: #ffffff;
      border: 1px solid #e0e0e0;
      color: #333;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
      box-shadow: 0 2px 4px rgba(16,24,40,0.04);
    }
    .page-btn:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 6px 18px rgba(16,24,40,0.08); }
    .page-btn.active {
      background: #ff6b6b; /* accent color */
      border-color: #ff6b6b;
      color: #fff;
      box-shadow: 0 6px 18px rgba(255,107,107,0.12);
    }
    .page-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
    #pagination .summary { margin-left: 16px; color: #6b7280; font-size: 0.95rem; }
    /* Small screens */
    @media (max-width: 520px) {
      .page-btn { padding: 6px 8px; font-size: 0.9rem; }
      #pagination { flex-direction: column; gap:8px; }
      #pagination .summary { margin-left: 0; font-size: 0.9rem; }
    }
  </style>

  <!-- Encabezado -->
  <header>
    <div class="logo">BEAT HOUSE</div>
    <nav>
      <ul>
        <li><a href="index.html">Inicio</a></li>
        <li><a href="#" id="btnChatbot">Contacto</a></li>
        <li><a href="loguin.html">Iniciar sesiÃ³n</a></li>
      </ul>
    </nav>
  </header>




 <!-- CatÃ¡logo principal -->
<section class="catalogo">
  <h2>Instrumentos destacados</h2>
  <div id="instruments-grid" class="grid">
    <!-- Instruments will be loaded here via AJAX -->
  </div>

  <div id="pagination" class="pagination" aria-label="PaginaciÃ³n instrumentos">
    <!-- Pagination controls injected here -->
  </div>

  <script>
  // Delegated cart handling for dynamically inserted product buttons
  document.addEventListener('click', function (e) {
    const btn = e.target.closest('.btn-carrito');
    if (!btn) return;
    const producto = {
      nombre: btn.dataset.nombre,
      precio: parseFloat(btn.dataset.precio),
      marca: btn.dataset.marca || '',
      color: btn.dataset.color || ''
    };
    localStorage.setItem('productoSeleccionado', JSON.stringify(producto));
    window.location.href = 'opcion.html';
  });

  // Fetch and render paginated instruments
  const grid = document.getElementById('instruments-grid');
  const pagination = document.getElementById('pagination');
  let currentPage = 0;
  const pageSize = 8;

  async function loadPage(page = 0) {
    currentPage = page;
    grid.innerHTML = '<p>Cargando...</p>';
    try {
      const res = await fetch(`http://localhost:8081/api/instruments?page=${page}&size=${pageSize}`);
      if (!res.ok) throw new Error('Error cargando instrumentos');
      const data = await res.json();
      renderGrid(data.content || data.content, data.number, data.totalPages, data.size, data.totalElements);
    } catch (err) {
      grid.innerHTML = '<p>Error al cargar instrumentos.</p>';
      console.error(err);
    }
  }

  function renderGrid(items, pageNumber, totalPages, size, totalElements) {
    if (!items || items.length === 0) {
      grid.innerHTML = '<p>No hay instrumentos disponibles.</p>';
      pagination.innerHTML = '';
      return;
    }

    grid.innerHTML = items.map(i => {
      const img = i.imageUrl ? i.imageUrl : 'RECURSOS/guitarra.png';
      const price = (i.price != null) ? ('s/.' + Number(i.price).toFixed(2)) : '';
      return `
        <div class="producto">
          <img src="http://localhost:8081${img}" alt="${escapeHtml(i.name)}" class="img-instrumento">
          <h3>${escapeHtml(i.name)}</h3>
          <p>${escapeHtml(i.category || '')}</p>
          <p class="precio">${price}</p>
          <button class="btn-carrito" data-nombre="${escapeHtml(i.name)}" data-precio="${i.price}">AÃ±adir al carrito</button>
        </div>`;
    }).join('');

    // render pagination controls
    let pagesHtml = '';
    pagesHtml += `<button ${pageNumber===0? 'disabled': ''} data-page="${pageNumber-1}" class="page-btn">Â« Anterior</button>`;
    // show up to 7 pages with current in center
    const visible = 7;
    let start = Math.max(0, pageNumber - Math.floor(visible/2));
    let end = Math.min(totalPages, start + visible);
    if (end - start < visible) start = Math.max(0, end - visible);
    for (let p = start; p < end; p++) {
      pagesHtml += `<button data-page="${p}" class="page-btn ${p===pageNumber? 'active': ''}">${p+1}</button>`;
    }
    pagesHtml += `<button ${pageNumber>=totalPages-1? 'disabled': ''} data-page="${pageNumber+1}" class="page-btn">Siguiente Â»</button>`;

    pagination.innerHTML = `<div class="pages">${pagesHtml}</div><div class="summary">Mostrando ${Math.min((pageNumber*size)+1, totalElements)} - ${Math.min((pageNumber+1)*size, totalElements)} de ${totalElements}</div>`;

    // attach click handlers
    pagination.querySelectorAll('.page-btn').forEach(b => b.addEventListener('click', (ev) => {
      const p = parseInt(ev.currentTarget.dataset.page, 10);
      if (!isNaN(p)) loadPage(p);
    }));
  }

  function escapeHtml(str) {
    if (!str) return '';
    return String(str)
      .replace(/&/g, '&amp;')
      .replace(/</g, '&lt;')
      .replace(/>/g, '&gt;')
      .replace(/"/g, '&quot;')
      .replace(/'/g, '&#39;');
  }

  // initial load
  loadPage(0);

  </script>

  <!-- Chatbot flotante BeatBot -->
<div id="chatbot-container" style="display:none;">
  <div id="chatbot-box">
    <div id="chatbot-header">ðŸŽ§ BeatBot</div>
    <div id="chatbot-messages">
      <div class="bot-message">ðŸ‘‹ Â¡Hola! Soy BeatBot, tu asistente virtual de BeatHouse.<br>
        Â¿En quÃ© puedo ayudarte hoy?
      </div>
      <div id="options">
        <button class="option">ðŸŽµ InformaciÃ³n sobre talleres</button>
        <button class="option">ðŸ§¾ InscripciÃ³n y boleta</button>
        <button class="option">ðŸ’³ Pagos y descuentos</button>
        <button class="option">ðŸ•’ Horarios y fechas</button>
        <button class="option">ðŸ“ž Hablar con un asesor</button>
      </div>
    </div>
    <div id="chatbot-input">
      <input type="text" id="userInput" placeholder="Escribe tu mensaje aquÃ­...">
      <button id="sendBtn">Enviar</button>
    </div>
  </div>
</div>




<script>
const btnChatbot = document.getElementById('btnChatbot');
const chatbotContainer = document.getElementById('chatbot-container');
const chatbotMessages = document.getElementById('chatbot-messages');
const userInput = document.getElementById('userInput');
const sendBtn = document.getElementById('sendBtn');
const options = document.querySelectorAll('.option');

// Mostrar / ocultar el chatbot al hacer clic
btnChatbot.addEventListener('click', (e) => {
  e.preventDefault();
  chatbotContainer.style.display = chatbotContainer.style.display === 'block' ? 'none' : 'block';
});

// Agregar mensajes al chat
function addMessage(text, sender = 'bot') {
  const msg = document.createElement('div');
  msg.classList.add(sender === 'bot' ? 'bot-message' : 'user-message');
  msg.innerHTML = text;
  chatbotMessages.appendChild(msg);
  chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
}

// Responder segÃºn la opciÃ³n seleccionada
options.forEach(option => {
  option.addEventListener('click', () => {
    const userChoice = option.textContent.trim();
    addMessage(userChoice, 'user');

    let response = '';
    if (userChoice.includes('taller')) {
      response = 'ðŸŽ¶ Ofrecemos talleres de canto, guitarra, baterÃ­a y producciÃ³n musical. Â¿Quieres que te envÃ­e el catÃ¡logo completo?';
      
    } else if (userChoice.includes('boleta')) {
      response = 'ðŸ§¾ Puedes generar tu boleta desde nuestra web al inscribirte. Recuerda tener tus datos actualizados.';
    } else if (userChoice.includes('Pagos') || userChoice.includes('descuentos')) {
      response = 'ðŸ’³ Aceptamos pagos por Yape, Plin y transferencia bancaria. Â¿Deseas los nÃºmeros de cuenta?';
    } else if (userChoice.includes('Horarios')) {
      response = 'ðŸ•’ Nuestros talleres inician cada lunes y sÃ¡bado. Â¿Te gustarÃ­a conocer el horario especÃ­fico de alguno?';
    } else if (userChoice.includes('asesor')) {
      window.open('https://wa.me/51982788020', '_blank');
      return;
    }
    addMessage(response);
  });
});

// Enviar mensaje manualmente
sendBtn.addEventListener('click', () => {
  const text = userInput.value.trim();
  if (!text) return;
  addMessage(text, 'user');
  userInput.value = '';

  // Palabras clave conocidas
  const keywords = ['taller', 'boleta', 'pago', 'horario', 'asesor', 'cuenta', 'inscripciÃ³n'];
  const known = keywords.some(k => text.toLowerCase().includes(k));

  if (!known) {
    addMessage('ðŸ¤– Parece una pregunta mÃ¡s especÃ­fica. Te conectarÃ© con un asesor humano...');
    setTimeout(() => {
      window.open('https://wa.me/51982788020', '_blank');
    }, 2000);
  } else {
    addMessage('Gracias por tu consulta ðŸ˜Š. Â¿Deseas mÃ¡s detalles o hablar con un asesor?');
  }
});
</script>

    <!-- FILAS 3, 4 y 5 (pueden repetirse con otras marcas o variaciones de modelo, como Guitarra ElÃ©ctrica, CajÃ³n Peruano, Tambor Africano, Violonchelo, MicrÃ³fono de Estudio, etc.) -->
  </div>
</section>
